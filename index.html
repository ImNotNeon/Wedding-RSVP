<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wedding RSVP</title>

  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;600&family=Tinos:wght@700&family=Montserrat:wght@400;500;600&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">

<style>
body {
      font-family: 'Raleway', sans-serif;
      background: #c3bdb5 url('Wedding.gif') no-repeat center bottom fixed;
      background-size: cover;
      text-align: center;
      padding: 30px;
      color: #4B2E2E;
      /* Changed overflow to allow vertical scrolling */
      overflow-x: hidden;
      overflow-y: auto; 
      /* Changed height to min-height so content can expand */
      min-height: 100vh;
      margin: 0;
    }

    /* LOGO CONTAINER */
    .logo-container {
      width: 100%;
      display: block;
      margin-top: 40px;
      animation: fadeIn 1.2s ease forwards;
    }
    
    .main-logo {
      max-width: 280px; 
      height: auto;
    }

    /* ALL SCREENS: Forced to 20px below whatever is above them */
    .screen {
      margin: 15px auto !important; /* This creates the 20px gap from the logo */
      max-width: 420px;
      background: #d4d0c7;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 12px rgba(0,0,0,0.2);
      display: none;
      position: relative;
      animation: fadeIn 0.8s ease forwards;
    }

    /* Keeping your specific screen overrides but ensuring the 20px gap */
    #nameScreen, #seatScreen, #alreadyRSVP {
      margin-top: 20px !important;
    }

    #thankYou {
      margin-top: 20px !important;
      background: transparent !important;
      box-shadow: none !important;
      width: 100%;
      max-width: 600px;
      padding-bottom: 50px;
    }

    /* FADE TRANSITION */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Rest of your existing styles (Loading, Inputs, Buttons, etc.) remain exactly as you wrote them */

    #loadingOverlay {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(195, 189, 181, 0.8);
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #4B2E2E;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loading-text {
      margin-top: 15px;
      font-family: 'Montserrat', sans-serif;
      font-size: 0.9em;
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    /* Rest of your existing styles... */
    body {
      font-family: 'Raleway', sans-serif;
      background: #c3bdb5 url('Wedding.gif') no-repeat center bottom fixed;
      background-size: cover;
      text-align: center;
      padding: 30px;
      color: #4B2E2E;
      overflow: hidden;
      height: 100vh;
    }
    h1, h2 {
      font-family: 'Tinos', serif;
      font-weight: 700;
      font-size: 2.5em;
      color: #4B2E2E;
    }
    h3 {
      font-family: 'Raleway', sans-serif;
      font-weight: 500;
      font-size: 1.8em;
      color: #4B2E2E;
    }
    h4 {
      font-family: 'Raleway', sans-serif;
      font-weight: 500;
      font-size: 1.5em;
      color: #4B2E2E;
    }
    .screen {
      margin: 360px auto 20px auto;
      max-width: 420px;
      background: #d4d0c7;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 12px rgba(0,0,0,0.2);
      display: none;
      position: relative;
    }
    .screen.transparent {
      background: transparent;
      box-shadow: none;
    }
    input, button {
      width: 85%;
      padding: 10px;
      margin: 10px 0;
      font-family: 'Raleway', sans-serif;
      border-radius: 6px;
      border: 1px solid #c9b6b3;
    }
    input[type="text"] {
      border-radius: 50px;
      background-color: #c4baa3;
      border: none;
      outline: none;
      padding: 12px 20px;
      color: #3e362b;
    }
    input[type="text"]::placeholder {
      color: #3e362b;
      opacity: 1;
    }
    input[type="text"]:focus {
      outline: none;
      border: none;
      box-shadow: none;
    }
    button {
      background: #b5aba4;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s ease;
    }
    button:hover {
      background: #c9b6b3;
    }
    #thankYou, #sorryMessage { display: none; }

    /* Autocomplete dropdown */
    .autocomplete-suggestions {
        position: absolute;
        background: #ffffff;
        border: 1px solid #ccc;
        border-radius: 6px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        max-height: 200px;
        overflow-y: auto;
        z-index: 1000;
        display: none;

        min-width: 250px; 
        width: calc(100% - 40px); 
        left: 50%;
        transform: translateX(-50%);
      }

      .autocomplete-suggestions div {
        background: #ffffff;
        padding: 10px;
        cursor: pointer;
        font-family: 'Montserrat', sans-serif;
        font-size: 1em;
        color: #4B2E2E;
      }

      .autocomplete-suggestions div:hover {
        background: #f2f2f2;
      }
    .highlight {
      font-weight: bold;
      color: #4B2E2E;
    }
    .attendance-text {
      font-family: 'Montserrat', sans-serif;
      margin-top: 20px;
    }
    .attendance-text-small {
      font-size: 0.85em;
      font-weight: 400;
    }
    .attendance-text-large {
      font-size: 1.1em;
      font-weight: 400;
      margin-top: -10px;
    }

    /* Attendance Icons (Yes/No) */
    .attendance-icon {
      width: 60px;
      height: 60px;
      display: inline-block;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      cursor: pointer;
      transition: transform 0.2s ease;
      opacity: 1 !important; /* Ensures no fading */
    }

    .attendance-icon:hover {
      transform: scale(1.15); /* The "pop" effect */
      opacity: 1 !important;
    }

    .attendance-icon:active {
      transform: scale(0.95); /* Pressed effect */
    }
    .seat-question {
      font-family: 'Montserrat', sans-serif;
      font-size: 1em;
      font-weight: 400;
      margin-top: 15px;
    }
    input[type="number"] {
      background-color: white;
      border: 2px solid #3e362b;
      border-radius: 8px;
      padding: 12px 20px;
      color: #3e362b;
      font-family: 'Montserrat', sans-serif;
      font-size: 1em;
      width: 85%;
      text-align: center;
    }
    input[type="number"]:focus {
      outline: none;
      border: 2px solid #3e362b;
    }
    .button-image {
      width: 60px;
      height: 60px;
      border: none;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-color: transparent;
      cursor: pointer;
      /* Smooth transition for both opacity and the enlarge effect */
      transition: transform 0.2s ease, opacity 0.3s ease, filter 0.2s ease;
    }

    .button-image:hover {
      opacity: 1; /* Keep it fully visible */
      background-color: transparent;
      transform: scale(1.15); /* This makes it enlarge like the link icons */
      filter: brightness(1.1); /* Optional: makes it slightly brighter on hover */
    }
    
    /* Active state: slight shrink when clicked for a "button press" feel */
    .button-image:active {
      transform: scale(0.95);
    }

    /* 1. Move seatScreen up specifically */
    #seatScreen {
      margin-top: 350px; /* Reduced from 360px to move it up */
    }

    /* 2. Style the seatMessage to match the question */
    #seatMessage {
      font-family: 'Tinos', serif;
      font-size: 1.1em; /* Matching the attendance-text-large size */
      font-weight: 700;
      margin-bottom: 5px;
    }

    /* Style for the Confirm button in seatScreen */
    #seatScreen button {
      width: 40%;           /* Matches the width of the input box */
      border-radius: 0px;   /* Makes corners sharp/square */
      padding: 10px;
      margin-top: 20px;
      display: inline-block; /* Allows it to sit nicely or be centered */
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    /* 3. Adjust the number input width and corners */
    input[type="number"] {
      background-color: white;
      border: 2px solid #3e362b;
      border-radius: 0px; /* Removed rounded corners */
      padding: 12px 10px;
      color: #3e362b;
      font-family: 'Montserrat', sans-serif;
      font-size: 1em;
      width: 40%; /* Reduced width */
      text-align: center;
      margin: 10px auto;
      display: block; /* Ensures centering with margin auto */
    }

    #rsvpForm {
      margin-top: 5px !important; 
      background: transparent;
      box-shadow: none;
      /* Prevent the form from going off-screen on small phones */
      max-height: 60vh; 
      overflow-y: auto;
      padding-bottom: 50px; /* Space for the button at the bottom */
    }
    
    /* Optional: Hide scrollbar for a cleaner look */
    #rsvpForm::-webkit-scrollbar {
      display: none;
    }

    /* Guest Input Box: White, Rounded Rectangle, Solid Shadow */
    input.guest-input-box {
      background-color: white !important;
      border: 2px solid #3e362b !important;
      border-radius: 12px !important; /* Rounded but rectangular */
      box-shadow: 6px 6px 0px 0px #3e362b !important; /* Solid bottom-right shadow */
      
      /* Resetting previous styles */
      padding: 12px 15px !important;
      width: 85% !important;
      margin: 10px auto 25px auto !important;
      display: block;
      color: #3e362b !important;
      font-family: 'Montserrat', sans-serif !important;
      outline: none !important;
    }

    /* Background for the RSVP stage */
    body.plain-bg {
      background: #c3bdb5 url('Plain.gif') no-repeat center bottom fixed !important;
      background-size: cover !important;
    }

    /* Style the RSVP form title to use Tinos */
    #rsvpForm h2 {
      font-family: 'Tinos', serif;
      font-size: 1.4em;
      margin-bottom: 25px;
      color: #3e362b;
    }

    /* Style for the alreadyRSVP screen specifically */
    #alreadyRSVP {
      font-family: 'Montserrat', sans-serif;
      color: #3e362b;
      margin-top: 360px; /* Keep it at the original height or adjust as needed */
    }

    #alreadyRSVP h2 {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.3em;
      font-weight: 600;
      margin-bottom: 10px;
      color: #3e362b; /* Matching the brown tone */
    }

    #alreadyRSVP p {
      font-family: 'Montserrat', sans-serif;
      font-size: 1em;
      font-weight: 400;
    }

    /* Sorry Screen Text Style */
    #sorryScreen {
      margin-top: 360px; /* Adjust height so it doesn't cover the GIF focus */
    }

    .cambria-text {
      /* Font Stack: Cambria is first, then "Hoefler Text" (Mac), then standard serif */
      font-family: Cambria, "Hoefler Text", "Liberation Serif", Times, "Times New Roman", serif;
      font-size: 1em;
      line-height: 1.6;
      color: #3e362b;
      max-width: 80%;
      margin: 0 auto;
    }

    /* Countdown Screen Styling */
    #thankYou {
      margin-top: 20px !important;
      background: transparent !important;
      box-shadow: none !important;
      width: 100%;
      max-width: 600px;
    }

    #timer {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 30px;
      color: #3e362b;
    }

    .time-unit {
      font-family: 'Montserrat', sans-serif;
      font-size: 0.8em;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .time-unit span {
      display: block;
      font-size: 2.5em;
      font-weight: 600;
      font-family: 'Tinos', serif;
    }

    .links-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.2em;
      margin-bottom: 20px;
      color: #3e362b;
    }

    .icon-row {
      display: flex;
      justify-content: center;
      gap: 35px;
    }

    .icon-link {
      width: 60px;
      height: 60px;
      display: inline-block;
      background-size: cover;
      background-position: center;
      transition: transform 0.2s ease;
    }

    .icon-link:hover {
      transform: scale(1.1);
    }

    body.final-bg {
      background: #c3bdb5 url('ThankYou.gif') no-repeat center bottom fixed !important;
      background-size: cover !important;
    }
</style>
</head>
<body>

  <div class="logo-container">
    <img src="Main.png" id="eventLogo" alt="Wedding Logo" class="main-logo">
  </div>

  <div id="loadingOverlay">
    <div class="spinner"></div>
    <div class="loading-text">Searching...</div>
  </div>

  <div id="nameScreen" class="screen transparent" style="display:block;">
    <input type="text" id="guestNameInput" placeholder="ðŸ”ï¸Ž ENTER NAME" autocomplete="off"/>
    <div id="autocomplete-list" class="autocomplete-suggestions"></div>
    <div class="attendance-text" style="margin-top:20px; font-family: Montserrat;">
      <p style="font-size: 0.85em;">Your presence would mean a lot to us,</p>
      <p style="font-size: 1.1em; margin-top: -10px;">Will you make it to our special day?</p>
    </div>
    <div style="display: flex; gap: 70px; justify-content: center; margin-top: 15px;">
      <a class="attendance-icon" onclick="checkName(true)" style="background-image: url('Yes.png');" role="button"></a>
      <a class="attendance-icon" onclick="checkName(false)" style="background-image: url('No.png');" role="button"></a>
    </div>
  </div>

  <div id="seatScreen" class="screen transparent">
    <h4 id="seatMessage" style="font-family: Tinos; font-weight:700;"></h4>
    <p style="font-family: Montserrat;">How many are attending?</p>
    <input type="number" id="seatCountInput" min="1" style="width:40%; border-radius:0; border: 2px solid #3e362b; padding:10px; margin: 10px auto; display:block;"/>
    <button onclick="confirmSeats()" style="width:40%; border-radius:0; padding:10px; background:#b5aba4; color:white; font-weight:600; cursor:pointer;">CONFIRM</button>
  </div>

  <form id="rsvpForm" class="screen transparent">
    <h2 style="font-size: 1.4em;">Please input name of attendees</h2>
    <div id="guestFields"></div>
    <button type="submit" style="width: 30%; background-color: #3e362b; color: #e7e3dc; padding:10px; border:none; cursor:pointer; font-weight:600;">RSVP</button>
  </form>

  <div id="sorryScreen" class="screen transparent">
    <p class="cambria-text">
      While we're sad you can't be with us in person, <br>
      we are deeply thankful for your love and support. <br><br>
      Your presence in our lives is a gift <br>
      and we look forward to celebrating life's moments together in the future.
    </p>
  </div>

  <div id="alreadyRSVP" class="screen transparent">
    <h2 style="font-size: 1.3em; font-family: Montserrat;">Already Received!</h2>
    <p style="font-family: Montserrat;">Please contact 0917-XXX-XXXX for changes.</p>
  </div>

<div id="thankYou" class="screen transparent">
    <div id="timer">
      <div class="time-unit"><span id="days">00</span>Days</div>
      <div class="time-unit"><span id="hours">00</span>Hrs</div>
      <div class="time-unit"><span id="minutes">00</span>Mins</div>
      <div class="time-unit"><span id="seconds">00</span>Secs</div>
    </div>
    <p style="font-family: Playfair Display; font-size: 1.2em;">Links that may help you</p>
    <div class="icon-row">
      <a href="https://maps.app.goo.gl/gHSZ2TiaBB8LUH3M7" target="_blank" rel="noopener noreferrer" class="icon-link" style="background-image: url('Church.png');"></a>
      <a href="https://maps.app.goo.gl/47ME3Vhk4NBPv9pQA" target="_blank" rel="noopener noreferrer" class="icon-link" style="background-image: url('Reception.png');"></a>
      <a href="mailto:yourweddingemail@example.com" target="_blank" rel="noopener noreferrer" class="icon-link" style="background-image: url('Email.png');"></a>
    </div>
  </div>

<script>
  /* All JS logic remains unchanged */
  let inviteList = {};
  let maxGuests = 0;
  let selectedName = "";
  let guestNumber = 0;

  function showScreen(screenId) {
    // 1. Hide all screens and show the target one
    document.querySelectorAll('.screen').forEach(s => s.style.display = 'none');
    document.getElementById(screenId).style.display = 'block';

    // 2. Logic to swap the logo based on the screen
    const logoImg = document.getElementById('eventLogo');
    
    if (screenId === 'rsvpForm' || screenId === 'sorryScreen') {
      logoImg.src = 'Logo.png';
    } else if (screenId === 'thankYou') {
      logoImg.src = 'TY.png';
    } else {
      logoImg.src = 'Main.png'; // Default for nameScreen, seatScreen, etc.
    }

    window.scrollTo(0,0);
  }

  function toggleLoading(show, text = "Searching...") {
    const loader = document.getElementById('loadingOverlay');
    loader.querySelector('.loading-text').innerText = text;
    loader.style.display = show ? 'flex' : 'none';
  }

  async function loadInviteList() {
    try {
      const res = await fetch("https://script.google.com/macros/s/AKfycbz_0Nc6tslk3AFka2Za9gdtpy63ucQeCNS_ETQebsL-ecSA86AH6r4RCDnUzW1uq4UF/exec");
      inviteList = await res.json();
    } catch (err) { console.error(err); }
  }
  loadInviteList();

  const input = document.getElementById("guestNameInput");
  const suggestionBox = document.getElementById("autocomplete-list");
  input.addEventListener("input", function() {
    const query = this.value.toUpperCase();
    suggestionBox.innerHTML = "";
    if (!query) { suggestionBox.style.display = "none"; return; }
    const matches = Object.keys(inviteList).filter(name => name.includes(query));
    if (matches.length === 0) { suggestionBox.style.display = "none"; return; }
    suggestionBox.style.display = "block";
    matches.forEach(match => {
      const div = document.createElement("div");
      div.innerText = match;
      div.onclick = () => { input.value = match; suggestionBox.style.display = "none"; };
      suggestionBox.appendChild(div);
    });
  });

  async function checkName(isAttending) {
    if (!isAttending) {
      toggleLoading(true, "Sending Regrets...");
      setTimeout(() => { toggleLoading(false); showScreen("sorryScreen"); }, 1000);
      return;
    }
    
    selectedName = input.value.trim().toUpperCase();
    if (!inviteList[selectedName]) {
      alert("Name not found. Please enter name exactly as on invitation.");
      return;
    }

    toggleLoading(true, "Verifying Name...");
    try {
      const res = await fetch("https://script.google.com/macros/s/AKfycbz_0Nc6tslk3AFka2Za9gdtpy63ucQeCNS_ETQebsL-ecSA86AH6r4RCDnUzW1uq4UF/exec?checkName=" + encodeURIComponent(selectedName));
      const data = await res.json();
      toggleLoading(false);

      if (data.exists) {
        showScreen("alreadyRSVP");
      } else {
        maxGuests = inviteList[selectedName];
        document.getElementById("seatMessage").innerText = `We've reserved ${maxGuests} seats for you!`;
        document.getElementById("seatCountInput").max = maxGuests;
        showScreen("seatScreen");
      }
    } catch (err) { toggleLoading(false); alert("Error connecting."); }
  }

  function confirmSeats() {
    const count = parseInt(document.getElementById("seatCountInput").value, 10);
    if (isNaN(count) || count < 1 || count > maxGuests) {
      alert(`Please enter a number between 1 and ${maxGuests}.`);
      return;
    }
    guestNumber = count;
    toggleLoading(true, "Preparing...");
    setTimeout(() => {
      toggleLoading(false);
      createGuestFields(count);
      showScreen("rsvpForm");
    }, 800);
  }

  function createGuestFields(n) {
    const container = document.getElementById("guestFields");
    container.innerHTML = "";
    for (let i = 1; i <= n; i++) {
      const inp = document.createElement("input");
      inp.type = "text"; inp.name = `guest${i}`; inp.placeholder = `Guest ${i} Name`;
      inp.required = true; inp.classList.add("guest-input-box");
      container.appendChild(inp);
    }
  }

  document.getElementById("rsvpForm").addEventListener("submit", async function(e) {
    e.preventDefault();
    toggleLoading(true, "Submitting RSVP...");
    const guestNames = [];
    for (let i = 1; i <= guestNumber; i++) { guestNames.push(this[`guest${i}`].value); }

    await fetch("https://script.google.com/macros/s/AKfycbz_0Nc6tslk3AFka2Za9gdtpy63ucQeCNS_ETQebsL-ecSA86AH6r4RCDnUzW1uq4UF/exec", {
      method: "POST", mode: "no-cors", body: JSON.stringify({ name: selectedName, guestNumber, guestNames })
    });

    setTimeout(() => {
      toggleLoading(false);
      showScreen("thankYou");
    }, 1500);
  });

  function startCountdown() {
    const targetDate = new Date("October 10, 2026 00:00:00").getTime();
    setInterval(() => {
      const distance = targetDate - new Date().getTime();
      document.getElementById("days").innerText = Math.floor(distance / 86400000);
      document.getElementById("hours").innerText = Math.floor((distance % 86400000) / 3600000);
      document.getElementById("minutes").innerText = Math.floor((distance % 3600000) / 60000);
      document.getElementById("seconds").innerText = Math.floor((distance % 60000) / 1000);
    }, 1000);
  }
  startCountdown();
</script>
</body>
</html>